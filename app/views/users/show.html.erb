<div class="row">
	<div class="col s7">
		<h4>My Upcoming Meetups</h4>
		<ul>
			<% @groups_with_meetups.each do |group| %>
				<ul class="collection with-header">
					<li class="collection-header"><h5><%= group.name %></h5></li>				
					<% group.meetups.first(3).each do |meetup| %>
						<a class="collection-item avatar homepage-meetup-link" href="<%= group_meetup_path(group, meetup) %>" onclick="dontFollowLinkIfMeetupAddress(event)">
							<img src="https://lh5.googleusercontent.com/p/AF1QipO0lQZzkbLIjulFFao737QyGg9GCsB6dWlNUduH=w81-h81-n-k-no" alt="" class="circle meetup-location-image">
							<span class="title meetup-title"><%= meetup.location.name %></span><br />
							<span class="meetup-date"><%= meetup.date.strftime("%A, %B %d") %></span><br />
							<span class="meetup-address"><%= meetup.location.address %></span>
							<%# <a href="#!" class="secondary-content"><i class="material-icons">grade</i></a> %>
						</a>
					<% end %>
				</ul>
			<% end %>
		</ul>
	</div>
	<div class="col s5 right-align">
		<h4>My Groups</h4>
		<ul>
			<% @user.groups.each do |group| %>
				<li>
					<%= link_to group.name, group %>
				</li>
			<% end %>
			<%= link_to "Join a new Group!", new_user_membership_path(@user) %></a>
		</ul>
	</div>
</div>
<script>
function dontFollowLinkIfMeetupAddress(event){
	if (event.target.className == 'meetup-address') {
		event.preventDefault()
		copyTextToClipboard(event.target.innerHTML)
		M.toast({html: 'Address copied to clipboard!'})
	}
}

function fallbackCopyTextToClipboard(text) {
  var textArea = document.createElement("textarea");
  textArea.value = text;
  
  // Avoid scrolling to bottom
  textArea.style.top = "0";
  textArea.style.left = "0";
  textArea.style.position = "fixed";

  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    var successful = document.execCommand('copy');
    var msg = successful ? 'successful' : 'unsuccessful';
    console.log('Fallback: Copying text command was ' + msg);
  } catch (err) {
    console.error('Fallback: Oops, unable to copy', err);
  }

  document.body.removeChild(textArea);
}
function copyTextToClipboard(text) {
  if (!navigator.clipboard) {
    fallbackCopyTextToClipboard(text);
    return;
  }
  navigator.clipboard.writeText(text).then(function() {
    console.log('Async: Copying to clipboard was successful!');
  }, function(err) {
    console.error('Async: Could not copy text: ', err);
  });
}
</script>
<br />
<p><i>Hello, <%= @user.name.split(' ')[0] %>! <%= @hello_messages.sample %></i></p>